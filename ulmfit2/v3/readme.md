This is v3 as modified by nwaves
